# 从正弦波说起

在数字信号处理领域, 没有比正弦/余弦波更基础而且重要的信号了.
它是这样简单以至于有时候我们会忽略其巨大的意义.
比如最简单的波形为什么是三角函数而不是圆弧?
为什么高手愿意用 $e^{j \omega t}$
或者 $e^{-j \omega t}$ 的形式?
这两个形式又有什么区别?

## 正弦函数与余弦函数

这两者本身就是三角函数, 没什么特别的含义, 怎么就成了数字信号处理的基本研究对象?
学习普通物理的时候我们知道, 最简单的振动被称为`简谐`振动.
而简谐振动的`幅度`随着`时间`变化就可以用 $\sin$ 或者 $\cos$ 函数来表示.
其他的波动过程, 包括声波, 光波, 电波都是跟简谐振动形式具有同样的基础形式:
比如单一频率的声波, 电波以及纯色的光波.

那为什么是三角函数而不是半圆呢? 半圆弧或者圆周运动似乎更基础啊?
这就是为什么我刚才强`调幅`度这个关键词.
这有一个非常重要的思想实验来理解这个问题.

**匀速旋转的理想杆:**
想象一根理想杆, 不可弯折, 有固定长度, 没有质量, 没有粗细.
其一端在一个固定轴上以均匀速度旋转, 类似时钟指针, 而另一端有个圆球.
理想杆垂直旋转, 其正上方有理想面光源(所有光线都是平行的)照下.
地面上圆球的`投影`的幅度随时间变化可以简单地用三角函数推断出来, 就是正弦或者余弦函数.

<!-- 这里应该有个图 -->

注意, 如果还有另一个理想理想面光源从水平方向照射理想杆, 我们还可以在与光线垂直的墙面得到另一个投影.
首先假设这个光线方向与转轴垂直, 那么墙面投影看起来与地面投影似乎没什么区别.
但是如果将其中之一(幅度对时间的函数)用正弦波表示, 另一个必然是余弦波.

总结一下:

* 一个匀速圆周运动的球在不同条件下的投影的幅度对时间变化的解可用三角函数表示.
* 正弦函数和余弦函数是对同一运动的两个垂直观察角度的结果. 确切地说是互相`正交`的两个观察角度.

## 正交基与维度压缩

我们可以从线性代数的`内积空间`这个概念来理解这个问题.
严格的定义比较复杂, 这里就不详细展开(其实我也说不清).
在例子中的理想杆可以理解为一个二维向量, 而顶点的圆球本身是作完美的匀速圆周运动.
然而我们观察的结果其实是这个二维运动在一维空间的投影.
两个垂直光源的投影构成了一对`正交基`, 也就是说:

* 任何在二维空间中的位置可以用这一对正交基唯一表示.
* 反之, 任何一对正交基对应这个二维空间中的唯一位置.

所谓正交或者垂直的含义类似.
严格说应该是`正交基之间的内积等于0`.
关于内积这个重要概念我们后面还要继续谈到.
现在简单将内积理解为投影过程.
如果理想杆平行于其中一个墙面, 其投影长度等于杆长,
那么在另一个墙面的投影长度为0.

一个二维向量通过正交基的投影变成了一对一维向量, 也就是维度被压缩了.
也就是所正弦波其实是经过维度压缩后的匀速圆周运动.
那我们能否直接用函数表示这个均匀圆周运动?
实数本身一维的, 但是如果引入了虚数, 增加了新的维度, 就可以表示二维向量了.

## 欧拉公式与复指数表达

接下来我要请出伟大的欧拉公式(Euler's formula):
$$e^{ix} = \cos x + i\sin x$$

我们可以注意到 $\cos$ 和 $\sin$, 两个正交基, 通过虚数符号组合在一起, 得到了一个复指数函数 $e^{ix}$.

当年我学到这里真的是很懵, 完全不理解这个恐怖的复指数函数出现的意义.
更可怕的是书的后面到处都是各种形式的这个家伙.
很久以后我才明白, 这就是一个旋转的二维向量罢了, 也可以理解为某个波动的函数.
完全可以拆解为 $\cos$ 和 $\sin$ 这两个三角函数的组合.
熟悉了就没有什么可怕的了, 可能一开始还是习惯于用三角函数表示, 但是很快就会爱上用复指数函数了.

## 幅度, 频率, 时间和相位

刚才讲到一个单频信号可以用复指数函数来表示.
下面给出具体公式:

$$A \cdot e^{j (\omega t +\phi)}$$

跟欧拉公式相比, 现在我们多了几个参数.
其中 $A$ 代表向量的长度, 也是信号最大幅度.
虚数标识 $i$ 换成了在工程上更加常见的 $j$.
剩下的几个参数分别是角频率 $\omega$, 时间 $t$ 和初始相位 $\phi$.
后三个(在括号中的)参数共同决定了信号的`瞬时相位`.

等一下, 幅度好理解, 那瞬时相位的含义呢?
瞬时(instant)意思是时间 $t$ 作为一个固定值, 而相位则是那个信号向量, 或者理想杆的角度.
范围在 $0^\circ$ ~ $360^\circ$, 或者用弧度表示为 $0$ ~ $2\pi$.
在平面直角坐标系(Cartesian coordinate system)中, 如果相位等于 $\pi$, 也就相当于信号向量从 $1+0j$ 旋转了 $180^\circ$ 到达 $-1+0j$.
于是我们得到了欧拉公式的另一个常见表述:

$$e^{i \pi} + 1 = 0$$
<!-- 这里应该有个图 -->

而当这个复指数函数的时间参数 $t$ 是一个(单调增加的)变量的时候, 应当将这个信号向量在脑中旋转起来.
旋转的速度由频率 $\omega$ 大小决定.
注意, 这里我们会遇到所谓正频率和负频率的问题.
从标量上当然无法解释负频率是什么.
然而当把信号理解为一个二维空间的旋转向量, 那频率的正负就有了明确的含义, 那就是旋转的方向.
当 $\omega$ 为正值时, 向量逆时针旋转; 而当 $\omega$ 为负时, 向量顺时针旋转.

最后再补充一点关于初始相位的理解.
很多情况下我们对初始相位 $\phi$ 讨论的不多.
但是在一些对时间敏感的应用中, 初始相位是最重要的参数.
比如在锁相环(phase lock loop, PLL)中, 相位同步才认为两个信号达到了同步.
在多径通信或者阵列信号处理中, 同一个信号被分时或者被多个接收机接收到.
由于波传播速度一般飞快, 其中的传播时间差极其微小, 难以测量.
然而靠相位差却能准确对时延进行估计.
这方面的内容将在后续讨论.
<!-- You can not see the following comment. -->

感谢阅读

刘肖 PhD

 x.liu@dal.ca

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。
